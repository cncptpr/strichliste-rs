#![cfg(feature = "ssr")]

use sqlx::{query, Executor};

use crate::backend::database::{DBError, DatabaseResponse, DatabaseType, TransactionDB};

impl TransactionDB {
    pub async fn set_undone<T>(conn: &mut T, id: i64, new_value: bool) -> DatabaseResponse<()>
    where
        for<'a> &'a mut T: Executor<'a, Database = DatabaseType>,
    {
        _ = query!(
            "
                update Transactions
                set is_undone = ?
                where id = ?
            ",
            new_value,
            id
        )
        .execute(&mut *conn)
        .await
        .map_err(DBError::new)?;

        Ok(())
    }
}
